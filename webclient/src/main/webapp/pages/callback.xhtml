<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
<ui:composition template="../templates/layout.xhtml">

	<ui:define name="content">

		<f:metadata>
		      <f:event type="preRenderView" listener="#{callbackBean.authorizeVerifierToken()}"  required="#{!facesContext.postback}" />
		      <f:viewParam id="oauth_verifier" name="oauth_verifier" value="#{callbackBean.oauth_verifier}"  />
		  <!-- <f:viewParam id="oauth_token" name="oauth_token" value="#{callbackBean.oauth_token}" required="#{!facesContext.postback}" />  -->    
		      <f:viewParam id="deny" name="deny" value="#{callbackBean.deny}"/>
		</f:metadata>

	    <p:panel id="mainPanel" toggleable="true" toggleSpeed="250">
	    	<f:facet name="header">
	        	<h:outputFormat value="#{messages.label_welcome_titlepane}" />
	      	</f:facet>
	  		<p />

			<h:form id="callback_form">
			    <h:panelGrid id="callback_panel" columns="2" style="margin-bottom:10px" cellpadding="5">
					Callback Page
				
					<h:outputText id="messageLog" value="#{callbackBean.messageLog}"  escape="false"/>
					<h:outputLabel for="runTestButton" value="Run next Tests:" />  
					<p:commandButton id="runTestButton" value="Next >>" action="#{callbackBean.runTest()}" ajax="true" update=":callback_form:callback_panel"  />
					<p:progressBar  value="#{sessionDataBean.testProgress}" />
					<h:messages />
					<h:outputText value="#{sessionDataBean.getTestRunIndex()} / #{sessionDataBean.getSelectedTests().size()}" />
					
					
			    </h:panelGrid>
			</h:form>
			
    	</p:panel>
    	
    	
	</ui:define>
</ui:composition>
</html>
